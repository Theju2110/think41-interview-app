CREATE DATABASE IF NOT EXISTS ecommerce;
USE ecommerce;

CREATE TABLE products (
    id INT PRIMARY KEY,
    cost DECIMAL(10, 2),
    category VARCHAR(100),
    name VARCHAR(255),
    brand VARCHAR(100),
    retail_price DECIMAL(10, 2),
    department VARCHAR(100),
    sku VARCHAR(100),
    distribution_center_id INT
);
SELECT * FROM products LIMIT 10;
show tables;


USE ecommerce;
SELECT * FROM products WHERE id = 1;

ALTER TABLE products DROP COLUMN department;

CREATE TABLE departments (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) UNIQUE NOT NULL
);

SELECT DISTINCT department FROM products;

INSERT INTO departments (name) VALUES ('Electronics'), ('Home'), ('Clothing');

ALTER TABLE products ADD COLUMN department_id INT;

CREATE INDEX idx_department_name ON departments(name);
CREATE INDEX idx_product_department ON products(department);

ALTER TABLE products
ADD CONSTRAINT fk_department
FOREIGN KEY (department_id) REFERENCES departments(id);

ALTER TABLE products ADD COLUMN department VARCHAR(255);
UPDATE products p
JOIN departments d ON p.department = d.name
SET p.department_id = d.id;

ALTER TABLE products DROP COLUMN department;

DESCRIBE products;
SET SQL_SAFE_UPDATES = 0;

SELECT DISTINCT category FROM products LIMIT 10;

SHOW COLUMNS FROM products LIKE 'category';
SELECT * FROM products WHERE category IS NOT NULL;




USE products;


SET SQL_SAFE_UPDATES = 1;

ALTER TABLE products DROP COLUMN department;

SELECT p.id, p.name, d.id as department_id, d.name as department_name
FROM products p
JOIN departments d ON p.department_id = d.id;


SELECT * FROM products WHERE department_id NOT IN (SELECT id FROM departments);

SELECT * FROM departments LIMIT 10;

SHOW CREATE TABLE products;

SELECT p.id, p.name, p.retail_price, d.id AS department_id, d.name AS department_name
FROM products p
LEFT JOIN departments d ON p.department_id = d.id
LIMIT 20;

SELECT * FROM departments;

ALTER TABLE products ADD COLUMN department VARCHAR(255);


UPDATE products
SET department_id = 1
WHERE category IN ('Electronics', 'Gadgets');

UPDATE products
SET department_id = 2
WHERE category IN ('Home', 'Furniture');

UPDATE products
SET department_id = 3
WHERE category IN ('Tops & Tees', 'Jeans', 'Dresses');

SELECT category FROM products;
SELECT DISTINCT category FROM products LIMIT 2;
SELECT COUNT(*) FROM products;

